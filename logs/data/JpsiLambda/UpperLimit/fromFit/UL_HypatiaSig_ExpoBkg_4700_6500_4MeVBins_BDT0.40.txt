Info in <StandardHypoTestInvDemo>: Model ModelConfig has no snapshot  - make one using model poi
Info in <StandardHypoTestInvDemo>: Using Minuit as minimizer for computing the test statistic
Info in <StandardHypoTestInvDemo>:  Doing a first fit to the observed data 
Info in <StandardHypoTestInvDemo>: HypoTestInverterResult has been written in the file Asym_CLs_grid_ts3_MyModel_HypatiaSig_ExpBkg_4700_6500_4MeVBins_BDT0.40.root
Warning in <TROOT::Append>: Replacing existing TH1: CLs_observed (Potential memory leak).
Warning in <TROOT::Append>: Replacing existing TH1: CLb_observed (Potential memory leak).
Warning in <TROOT::Append>: Replacing existing TH1: CLs+b_observed (Potential memory leak).
Info in <TCanvas::Print>: pdf file ../plots/data/JpsiLambda/UpperLimit/Asymptotic/CLs_HypatiaSig_ExpoBkg_4700_6500.pdf has been created
3
RooHistPdf::LST1520[ pdfObs=(Lb_DTF_M_JpsiLConstr) ] = 131.57
RooHypatia2::Lb_Run1[ x=Lb_DTF_M_JpsiLConstr l=lambda_Run1 zeta=0 fb=0 sigma=sigma_Run1 mu=mean_Run1 a=a1_Run1 n=2 a2=a2_Run1 n2=2 ] = 7.52459e-06
RooHypatia2::Lb_Run2[ x=Lb_DTF_M_JpsiLConstr l=lambda_Run2 zeta=0 fb=0 sigma=sigma_Run2 mu=mean_Run2 a=a1_Run2 n=2 a2=a2_Run2 n2=2 ] = 3.95103e-06
RooKeysPdf::SIG1[ x=Lb_DTF_M_JpsiLConstr ] = 4.75746e-13
RooKeysPdf::SIG2[ x=Lb_DTF_M_JpsiLConstr ] = 1.23779e-07
RooKeysPdf::XIB1[ x=Lb_DTF_M_JpsiLConstr ] = 0
RooKeysPdf::XIB2[ x=Lb_DTF_M_JpsiLConstr ] = 4.75541e-07
RooGaussian::eff_ratio_constraint1[ x=geff_ratio1 mean=eff_ratio1 sigma=0.025213 ] = 0.999667
RooGaussian::eff_ratio_constraint2[ x=geff_ratio2 mean=eff_ratio2 sigma=0.021739 ] = 0.999913
RooGaussian::lstLump_Run1[ x=Lb_DTF_M_JpsiLConstr mean=miscLstMean_Run1 sigma=miscLstSigma_Run1 ] = 3.10277e-07
RooGaussian::lstLump_Run2[ x=Lb_DTF_M_JpsiLConstr mean=miscLstMean_Run2 sigma=miscLstSigma_Run2 ] = 4.63196e-06
RooAddPdf::model1[ nSigma1 * SIG1 + nLb_Run1 * Lb_Run1 + nXib1 * XIB1 + n1405_Run1 * LST1405 + n1520_Run1 * LST1520 + nMiscLst_Run1 * lstLump_Run1 + nBkg_Run1 * Bkg_Run1 ] = 28.4503
RooAddPdf::model2[ nSigma2 * SIG2 + nLb_Run2 * Lb_Run2 + nXib2 * XIB2 + n1405_Run2 * LST1405 + n1520_Run2 * LST1520 + nMiscLst_Run2 * lstLump_Run2 + nBkg_Run2 * Bkg_Run2 ] = 17.6554
RooProdPdf::model_const1[ model1 * eff_ratio_constraint1 * nXib_constraint1 ] = 28.0588
RooProdPdf::model_const2[ model2 * eff_ratio_constraint2 * nXib_constraint2 ] = 17.2178
RooGaussian::nXib_constraint1[ x=gnXib1 mean=nXib1 sigma=2.05443 ] = 0.986566
RooGaussian::nXib_constraint2[ x=gnXib2 mean=nXib2 sigma=10.9513 ] = 0.975301
RooSimultaneous::simPdf[ indexCat=sample run1=model_const1 run2=model_const2 ] = 14.6726

functions
--------
RooFormulaVar::nSigma1[ actualVars=(R,nLb_Run1,eff_ratio1) formula="pow(10,-5)*R*nLb_Run1*eff_ratio1" ] = 4.7621
RooFormulaVar::nSigma2[ actualVars=(R,nLb_Run2,eff_ratio2) formula="pow(10,-5)*R*nLb_Run2*eff_ratio2" ] = 27.4027

datasets
--------
RooDataHist::ds1(Lb_DTF_M_JpsiLConstr)
RooDataHist::ds2(Lb_DTF_M_JpsiLConstr)
RooDataHist::combData(sample,Lb_DTF_M_JpsiLConstr)

embedded datasets (in pdfs and functions)
-----------------------------------------
RooDataHist::ds_lst1405_smooth(Lb_DTF_M_JpsiLConstr)
RooDataHist::ds_lst1520_smooth(Lb_DTF_M_JpsiLConstr)

parameter snapshots
-------------------
ModelConfig__snapshot = (R=134.568 +/- (0,182.957))
bkgOnlyModel__snapshot = (R=0 +/- (0,182.957))

named sets
----------
ModelConfig_GlobalObservables:(geff_ratio1,gnXib1,geff_ratio2,gnXib2)
ModelConfig_NuisParams:(nLb_Run1,mean_Run1,sigma_Run1,lambda_Run1,a1_Run1,a2_Run1,nBkg_Run1,tau_Run1,nMiscLst_Run1,miscLstMean_Run1,miscLstSigma_Run1,eff_ratio1,nXib1,n1405_Run1,n1520_Run1,nLb_Run2,mean_Run2,sigma_Run2,lambda_Run2,a1_Run2,a2_Run2,nBkg_Run2,tau_Run2,nMiscLst_Run2,miscLstMean_Run2,miscLstSigma_Run2,eff_ratio2,nXib2,n1405_Run2,n1520_Run2)
ModelConfig_Observables:(Lb_DTF_M_JpsiLConstr,sample)
ModelConfig_POI:(R)
ModelConfig__snapshot:(R)
bkgOnlyModel__snapshot:(R)
globObs:(geff_ratio1,gnXib1,geff_ratio2,gnXib2)
nuisParams:(nLb_Run1,mean_Run1,sigma_Run1,lambda_Run1,a1_Run1,a2_Run1,nBkg_Run1,tau_Run1,nMiscLst_Run1,miscLstMean_Run1,miscLstSigma_Run1,eff_ratio1,nXib1,n1405_Run1,n1520_Run1,nLb_Run2,mean_Run2,sigma_Run2,lambda_Run2,a1_Run2,a2_Run2,nBkg_Run2,tau_Run2,nMiscLst_Run2,miscLstMean_Run2,miscLstSigma_Run2,eff_ratio2,nXib2,n1405_Run2,n1520_Run2)
obs:(Lb_DTF_M_JpsiLConstr,sample)
poi:(R)

generic objects
---------------
RooStats::ModelConfig::ModelConfig
RooStats::ModelConfig::bkgOnlyModel

Using data set combData
[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
StandardHypoTestInvDemo : POI initial value:   R = 134.568
[#1] INFO:Minization -- p.d.f. provides expected number of events, including extended term in likelihood.
[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_simPdf_FOR_OBS_Lb_DTF_M_JpsiLConstr:sample with 4 entries
[#1] INFO:Minization --  Including the following contraint terms in minimization: (eff_ratio_constraint1,nXib_constraint1,eff_ratio_constraint2,nXib_constraint2)
RooAbsTestStatistic::initSimMode: creating slave calculator #0 for state run1 (450 dataset entries)
[#1] INFO:NumericIntegration -- RooRealIntegral::init(Lb_Run1_Int[Lb_DTF_M_JpsiLConstr]) using numeric integrator RooIntegrator1D to calculate Int(Lb_DTF_M_JpsiLConstr)
RooAbsTestStatistic::initSimMode: creating slave calculator #1 for state run2 (450 dataset entries)
[#1] INFO:NumericIntegration -- RooRealIntegral::init(Lb_Run2_Int[Lb_DTF_M_JpsiLConstr]) using numeric integrator RooIntegrator1D to calculate Int(Lb_DTF_M_JpsiLConstr)
[#1] INFO:Fitting -- RooAbsTestStatistic::initSimMode: created 2 slave calculators.
[#1] INFO:Fitting -- RooAddition::defaultErrorLevel(nll_simPdf_combData_with_constr) Summation contains a RooNLLVar, using its error level
[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization
[#1] INFO:NumericIntegration -- RooRealIntegral::init(Lb_Run1_Int[Lb_DTF_M_JpsiLConstr]) using numeric integrator RooIntegrator1D to calculate Int(Lb_DTF_M_JpsiLConstr)
[#1] INFO:NumericIntegration -- RooRealIntegral::init(Lb_Run1_Int[Lb_DTF_M_JpsiLConstr]) using numeric integrator RooIntegrator1D to calculate Int(Lb_DTF_M_JpsiLConstr)
[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (SIG1,XIB1,LST1405,LST1520)
[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (Lb_Run1,lstLump_Run1,Bkg_Run1)
[#1] INFO:NumericIntegration -- RooRealIntegral::init(Lb_Run2_Int[Lb_DTF_M_JpsiLConstr]) using numeric integrator RooIntegrator1D to calculate Int(Lb_DTF_M_JpsiLConstr)
[#1] INFO:NumericIntegration -- RooRealIntegral::init(Lb_Run2_Int[Lb_DTF_M_JpsiLConstr]) using numeric integrator RooIntegrator1D to calculate Int(Lb_DTF_M_JpsiLConstr)
[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (SIG2,XIB2,LST1405,LST1520)
[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (Lb_Run2,lstLump_Run2,Bkg_Run2)
 **********
 **    1 **SET PRINT           0
 **********
 **********
 **    2 **SET NOGRAD
 **********
 PARAMETER DEFINITIONS:
    NO.   NAME         VALUE      STEP SIZE      LIMITS
     1 R            1.34568e+02  9.22140e+01   -1.00000e+03  1.00000e+03
     2 a1_Run1      1.07274e+00  3.22773e-04    1.00000e+00  3.00000e+00
     3 a1_Run2      1.93695e+00  7.55254e-02    1.00000e+00  3.00000e+00
     4 a2_Run1      1.06491e+00  4.05578e-02    1.00000e+00  3.00000e+00
     5 a2_Run2      2.25822e+00  1.09041e-01    1.00000e+00  3.00000e+00
     6 eff_ratio1   8.22978e-01  1.85243e-02    0.00000e+00  1.00000e+00
     7 eff_ratio2   9.64210e-01  1.58584e-02    0.00000e+00  1.00000e+00
     8 lambda_Run1  -2.98466e+00  2.01674e-01   -3.00000e+00  0.00000e+00
 MINUIT WARNING IN PARAMETR
 ============== VARIABLE8 BROUGHT BACK INSIDE LIMITS.
     9 lambda_Run2  -2.05611e+00  1.67335e-02   -4.00000e+00  0.00000e+00
    10 mean_Run1    5.61950e+03  8.75705e-02    5.61900e+03  5.62100e+03
    11 mean_Run2    5.61974e+03  4.08484e-02    5.61900e+03  5.62100e+03
    12 miscLstMean_Run1   5.01981e+03  2.72413e+00    4.98000e+03  5.05000e+03
    13 miscLstMean_Run2   5.01462e+03  1.22716e+00    4.98000e+03  5.05000e+03
    14 miscLstSigma_Run1   5.80511e+01  2.35425e+00    2.00000e+01  1.00000e+02
    15 miscLstSigma_Run2   6.30749e+01  1.06264e+00    2.00000e+01  1.00000e+02
    16 n1405_Run1   2.94292e+02  3.14766e+01    5.00000e+01  1.00000e+04
    17 n1405_Run2   1.83369e+03  7.87791e+01    5.00000e+01  1.00000e+04
    18 n1520_Run1   1.54293e+03  4.49865e+01    1.00000e+00  1.00000e+04
    19 n1520_Run2   5.43851e+03  1.18262e+02    1.00000e+00  1.00000e+04
    20 nBkg_Run1    3.43800e+02  2.06553e+01    1.00000e+00  7.27800e+03
    21 nBkg_Run2    8.40742e+03  1.01040e+02    1.00000e+00  4.19480e+04
    22 nLb_Run1     4.30001e+03  4.84386e+01    1.00000e+03  7.00000e+03
    23 nLb_Run2     2.11194e+04  1.08195e+02    1.00000e+03  2.50000e+04
    24 nMiscLst_Run1   7.77879e+02  3.12749e+01    1.00000e+00  5.00000e+03
    25 nMiscLst_Run2   4.98038e+03  8.22872e+01    1.00000e+00  7.00000e+03
    26 nXib1        1.33828e+01  1.49504e+00    0.00000e+00  2.00000e+02
    27 nXib2        1.44183e+02  7.92379e+00    0.00000e+00  4.00000e+02
    28 sigma_Run1   1.64628e+01  2.35173e-01    1.00000e+00  2.00000e+01
    29 sigma_Run2   1.37271e+01  7.87410e-02    1.00000e+00  2.00000e+01
    30 tau_Run1    -9.99999e-03  8.82112e-04   -1.00000e-02 -1.00000e-07
 MINUIT WARNING IN PARAMETR
 ============== VARIABLE30 BROUGHT BACK INSIDE LIMITS.
    31 tau_Run2    -3.08225e-03  3.18636e-05   -1.00000e-02 -1.00000e-07
 **********
 **    3 **SET ERR         0.5
 **********
 **********
 **    4 **SET PRINT           0
 **********
 **********
 **    5 **SET STR           0
 **********
 **********
 **    6 **MIGRAD    1.55e+04           1
 **********
[#1] INFO:Minization -- RooNLLVar::evaluatePartition(run1) first = 0 last = 450 Likelihood offset now set to -12285.1
[#1] INFO:Minization -- RooNLLVar::evaluatePartition(run2) first = 0 last = 450 Likelihood offset now set to -131598
 MIGRAD MINIMIZATION HAS CONVERGED.
 FCN=-8.22711 FROM MIGRAD    STATUS=CONVERGED    3835 CALLS        3836 TOTAL
                     EDM=1.57442e-05    STRATEGY= 0  ERROR MATRIX UNCERTAINTY   4.9 per cent
  EXT PARAMETER                                   STEP         FIRST   
  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE 
   1  R           -2.66497e+02   1.74070e+02   1.06345e-03   6.65491e-03
   2  a1_Run1      1.65740e+00   1.23852e-01   5.88902e-04  -1.45049e-02
   3  a1_Run2      1.65994e+00   9.55234e-02   1.45979e-03  -2.20474e-02
   4  a2_Run1      1.85465e+00   1.96757e-04  -2.39775e-06  -1.07116e-01
   5  a2_Run2      2.19015e+00   1.81813e-01   4.12695e-03   1.74176e-02
   6  eff_ratio1   8.22309e-01   2.52211e-02   1.13535e-04   4.33752e-03
   7  eff_ratio2   9.64520e-01   2.16134e-02   1.66984e-04   2.00931e-03
   8  lambda_Run1  -2.05108e+00   2.19563e-02   1.41866e-04   9.66934e-02
   9  lambda_Run2  -2.12778e+00   5.93698e-02   8.04158e-04  -3.48485e-01
  10  mean_Run1    5.61950e+03   7.90805e-06  -1.65857e-07  -1.07928e+00
  11  mean_Run2    5.61974e+03   5.56882e-02  -9.75810e-06  -3.16420e-04
  12  miscLstMean_Run1   5.01985e+03   4.06180e+00  -1.05226e-03  -1.51814e-03
  13  miscLstMean_Run2   5.01427e+03   1.89805e+00  -6.74094e-04  -3.28708e-02
  14  miscLstSigma_Run1   5.94410e+01   4.32986e+00   2.28326e-03   2.42988e-02
  15  miscLstSigma_Run2   6.34311e+01   1.81304e+00  -1.86872e-04  -3.68741e-02
  16  n1405_Run1   4.82128e+02   9.49067e+01   9.27693e-04  -1.56605e-02
  17  n1405_Run2   1.96532e+03   2.74067e+02   3.66950e-04  -2.70632e-02
  18  n1520_Run1   9.42076e+02   1.77209e+02  -1.53565e-03  -1.23339e-01
  19  n1520_Run2   5.13768e+03   5.71594e+02  -1.04117e-04   4.05853e-02
  20  nBkg_Run1    7.69145e+02   7.05502e+01   4.64321e-04   3.32478e-02
  21  nBkg_Run2    8.56661e+03   2.16278e+02  -9.25702e-05  -2.31682e-01
  22  nLb_Run1     4.27052e+03   6.62581e+01  -7.18756e-05  -2.39834e-02
  23  nLb_Run2     2.11536e+04   1.47875e+02   1.35434e-06   9.78692e-03
  24  nMiscLst_Run1   8.10370e+02   7.06567e+01   7.17658e-04  -2.74889e-02
  25  nMiscLst_Run2   5.03433e+03   1.86973e+02  -5.30692e-05  -3.42474e-02
  26  nXib1        1.30472e+01   2.02143e+00   2.41889e-04   3.68357e-02
  27  nXib2        1.45740e+02   1.07610e+01  -3.61673e-04  -1.93324e-02
  28  sigma_Run1   1.32601e+01   1.10348e-01   1.07290e-04   1.52855e-01
  29  sigma_Run2   1.40019e+01   2.61993e-01  -7.91447e-04   1.17605e-01
  30  tau_Run1    -4.01718e-03   3.02841e-04  -1.27526e-04   4.04167e-03
  31  tau_Run2    -3.06406e-03   4.92676e-05  -6.85795e-06   7.15627e-02
                               ERR DEF= 0.5
[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization
StandardHypoTestInvDemo - Best Fit value : R = -266.497 +/- 174.07
Time for fitting : Real time 0:00:03, CP time 3.070
[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
StandardHypoTestInvo: snapshot of S+B Model ModelConfig is set to the best fit value
[#0] PROGRESS:Eval -- AsymptoticCalculator::Initialize....
[#0] PROGRESS:Eval -- AsymptoticCalculator::Initialize - Find  best unconditional NLL on observed data
[#0] PROGRESS:Eval -- Best fitted POI value = -265.79 +/- 124.491
[#0] PROGRESS:Eval -- AsymptoticCalculator: Building Asimov data Set
[#1] INFO:InputArguments -- AsymptoticCalculator: Asimov data will be generated using fitted nuisance parameter values
[#0] PROGRESS:Eval -- AsymptoticCalculator::Initialize Find  best conditional NLL on ASIMOV data set for given alt POI ( R ) = 0
[#1] INFO:InputArguments -- HypoTestInverter ---- Input models: 
		 using as S+B (null) model     : ModelConfig
		 using as B (alternate) model  : bkgOnlyModel

Doing a fixed scan  in interval : 0 , 1000
[#1] INFO:Eval -- HypoTestInverter::GetInterval - run a fixed scan
[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 0
[#1] INFO:InputArguments -- Minimum of POI is -1000 is different to alt snapshot 0 - using standard q asymptotic formulae  
[#0] PROGRESS:Eval -- P values for  R =  0
	CLs      = 1 +/- 0
	CLb      = 0.0949332 +/- 0
	CLsplusb = 0.0949332 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 111.111
[#0] PROGRESS:Eval -- P values for  R =  111.111
	CLs      = 0.278591 +/- 0
	CLb      = 0.134914 +/- 0
	CLsplusb = 0.037586 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 222.222
[#0] PROGRESS:Eval -- P values for  R =  222.222
	CLs      = 0.0695108 +/- 0
	CLb      = 0.15229 +/- 0
	CLsplusb = 0.0105858 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 333.333
[#0] PROGRESS:Eval -- P values for  R =  333.333
	CLs      = 0.0128479 +/- 0
	CLb      = 0.164391 +/- 0
	CLsplusb = 0.00211208 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 444.444
[#0] PROGRESS:Eval -- P values for  R =  444.444
	CLs      = 0.00229087 +/- 0
	CLb      = 0.151808 +/- 0
	CLsplusb = 0.000347774 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 555.556
[#0] PROGRESS:Eval -- P values for  R =  555.556
	CLs      = 0.000305683 +/- 0
	CLb      = 0.148196 +/- 0
	CLsplusb = 4.53011e-05 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 666.667
[#0] PROGRESS:Eval -- P values for  R =  666.667
	CLs      = 3.57633e-05 +/- 0
	CLb      = 0.15945 +/- 0
	CLsplusb = 5.70245e-06 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 777.778
[#0] PROGRESS:Eval -- P values for  R =  777.778
	CLs      = 3.08287e-06 +/- 0
	CLb      = 0.168933 +/- 0
	CLsplusb = 5.20799e-07 +/- 0

[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 888.889
    ----> Doing a re-scan first
    ----> trying with strategy = 1
    ----> trying with improve
[#0] ERROR:Minization -- AsymptoticCalculator:  failure in fitting for qmu or qmuA 888.889 return a dummy result 
[#0] PROGRESS:Eval -- P values for  R =  888.889
	CLs      = nan +/- 0
	CLb      = nan +/- 0
	CLsplusb = nan +/- 0

[#0] WARNING:Eval -- HypoTestInverter - Skip invalid result for  point R = 888.889
[#1] INFO:ObjectHandling -- RooWorkspace::saveSnaphot(w) replacing previous snapshot with name ModelConfig__snapshot
[#0] PROGRESS:Eval -- Running for R = 1000
[#0] PROGRESS:Eval -- P values for  R =  1000
	CLs      = 1.76671e-08 +/- 0
	CLb      = 0.20297 +/- 0
	CLsplusb = 3.58588e-09 +/- 0

Time to perform limit scan 
Real time 0:00:36, CP time 36.890
The computed lower limit is: -1000 +/- 0
The computed upper limit is: 260.481 +/- 0
Expected upper limits, using the B (alternate) model : 
 expected limit (median) 358.896
 expected limit (-1 sig) 262.707
 expected limit (+1 sig) 532.958
 expected limit (-2 sig) 200.883
 expected limit (+2 sig) 733.71
