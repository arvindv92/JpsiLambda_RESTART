Info in <TCanvas::Print>: pdf file plots/fit_run2LL_ZeroTracks.pdf has been created
Info in <TCanvas::Print>: pdf file plots/fit_run2LL_sWeights_ZeroTracks.pdf has been created
Info in <TCanvas::Print>: pdf file plots/fit_run2LL_sWeightsVsMass_ZeroTracks.pdf has been created
Info in <TCanvas::Print>: pdf file plots/fit_run2LL_sWeightedMass.pdf has been created
iLambda/run2/jpsilambda_LL_withsw_ZeroTracks.root
******************************************
Making mass cut on 81528 entries
0
Starting AddModel()
Making signal model
Making background model
Importing model into workspace
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooAddPdf::model
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooAddPdf::sig
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooGaussian::sig1
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::Lb_DTF_M_JpsiLConstr
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::mean
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigma1
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::frac1
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooGaussian::sig2
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigma2
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigYield
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooExponential::bkg
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::tau
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::bkgYield

RooWorkspace(myWS) myWS contents

variables
---------
(Lb_DTF_M_JpsiLConstr,bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 0.0198411
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.0205464
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.0213153
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.0213153
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.0213153

AddModel() complete
Starting AddData()
Importing data. This could take a while. Sit tight
[#1] INFO:Eval -- RooTreeDataStore::loadValues(data) Ignored 70625 out of range events
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing dataset data
[#1] INFO:ObjectHandling -- RooWorkSpace::import(myWS) changing name of dataset from  data to data

RooWorkspace(myWS) myWS contents

variables
---------
(Lb_DTF_M_JpsiLConstr,bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 0.0198411
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.0205464
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.0213153
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.0213153
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.0213153

datasets
--------
RooDataSet::data(Lb_DTF_M_JpsiLConstr)

Finishing AddData()

RooWorkspace(myWS) myWS contents

variables
---------
(Lb_DTF_M_JpsiLConstr,bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 0.0198411
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.0205464
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.0213153
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.0213153
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.0213153

datasets
--------
RooDataSet::data(Lb_DTF_M_JpsiLConstr)

Starting DoSPlot()
Calculating sWeights
[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_model_FOR_OBS_Lb_DTF_M_JpsiLConstr with 0 entries
[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization
[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (sig1,sig2,bkg)
 **********
 **    1 **SET PRINT           1
 **********
 **********
 **    2 **SET NOGRAD
 **********
 PARAMETER DEFINITIONS:
    NO.   NAME         VALUE      STEP SIZE      LIMITS
     1 bkgYield     5.45100e+03  1.09030e+03    0.00000e+00  1.09030e+04
     2 frac1        5.00000e-01  9.90000e-02    1.00000e-02  1.00000e+00
     3 mean         5.61942e+03  2.00000e-01    5.61900e+03  5.62100e+03
     4 sigYield     5.00000e+03  2.50000e+03    0.00000e+00  1.00000e+05
     5 sigma1       7.00000e+00  1.00000e+00    5.00000e+00  2.00000e+01
     6 sigma2       7.00000e+00  1.70000e+00    3.00000e+00  2.00000e+01
     7 tau         -7.00000e-04  3.49950e-04   -1.00000e-02 -1.00000e-07
 **********
 **    3 **SET ERR         0.5
 **********
 **********
 **    4 **SET PRINT           1
 **********
 **********
 **    5 **SET STR           2
 **********
 NOW USING STRATEGY  2: MAKE SURE MINIMUM TRUE, ERRORS CORRECT  
 **********
 **    6 **MIGRAD        3500           1
 **********
 FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.
 START MIGRAD MINIMIZATION.  STRATEGY  2.  CONVERGENCE WHEN EDM .LT. 1.00e-03
 MINUIT WARNING IN HESSE
 ============== Second derivative zero for parameter2
  MNHESS FAILS AND WILL RETURN DIAGONAL MATRIX. 
 FCN=-15706.5 FROM HESSE     STATUS=FAILED         11 CALLS          12 TOTAL
                     EDM=3476.86    STRATEGY= 2  ERROR MATRIX UNCERTAINTY 100.0 per cent
  EXT PARAMETER                APPROXIMATE        STEP         FIRST   
  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE 
   1  bkgYield     5.45100e+03   5.63689e+01   2.86370e-02  -4.01831e+03
   2  frac1        5.00000e-01   7.02412e-02   2.01369e-01   9.93203e+00
   3  mean         5.61942e+03   1.44637e-01   2.52435e-01   7.92284e+00
   4  sigYield     5.00000e+03   1.82600e+03   1.18625e-01   1.68598e+01
   5  sigma1       7.00000e+00   7.27597e-01   2.02490e-01   9.87702e+00
   6  sigma2       7.00000e+00   1.22237e+00   2.40891e-01   8.30252e+00
   7  tau         -7.00000e-04   2.55369e-04   1.41792e-01   1.41052e+01
                               ERR DEF= 0.5
 MIGRAD MINIMIZATION HAS CONVERGED.
 MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.
 COVARIANCE MATRIX CALCULATED SUCCESSFULLY
 FCN=-19349.5 FROM MIGRAD    STATUS=CONVERGED     474 CALLS         475 TOTAL
                     EDM=0.000105519    STRATEGY= 2      ERROR MATRIX ACCURATE 
  EXT PARAMETER                                   STEP         FIRST   
  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE 
   1  bkgYield     9.70784e+03   1.05450e+02   2.82915e-03  -9.92654e-02
   2  frac1        7.03898e-01   6.32433e-02   7.36105e-03   3.49388e-02
   3  mean         5.61942e+03   2.77497e-01   3.26586e-02   1.22864e-02
   4  sigYield     1.19507e+03   5.11802e+01   3.62405e-04   1.70052e+00
   5  sigma1       5.75108e+00   4.02394e-01   7.33240e-03   4.25279e-02
   6  sigma2       1.90817e+01   1.25303e+01   6.70798e-02  -4.83791e-03
   7  tau         -1.93966e-03   4.75997e-05   1.13778e-03  -2.70254e-01
                               ERR DEF= 0.5
 EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  7    ERR DEF=0.5
  1.112e+04  1.627e-01  3.341e-01 -1.419e+03  2.838e+00 -9.449e+01  3.679e-04 
  1.627e-01  4.026e-03 -2.919e-03 -1.629e-01 -1.948e-02  1.735e-01  4.445e-08 
  3.341e-01 -2.919e-03  8.017e-02 -3.353e-01  2.114e-02 -1.433e-01 -1.191e-08 
 -1.419e+03 -1.629e-01 -3.353e-01  2.619e+03 -2.848e+00  9.486e+01 -3.690e-04 
  2.838e+00 -1.948e-02  2.114e-02 -2.848e+00  1.627e-01 -1.051e+00  7.140e-07 
 -9.449e+01  1.735e-01 -1.433e-01  9.486e+01 -1.051e+00  1.980e+01 -2.463e-05 
  3.679e-04  4.445e-08 -1.191e-08 -3.690e-04  7.140e-07 -2.463e-05  2.266e-09 
 PARAMETER  CORRELATION COEFFICIENTS  
       NO.  GLOBAL      1      2      3      4      5      6      7
        1  0.30847   1.000  0.024  0.011 -0.263  0.067 -0.201  0.073
        2  0.83750   0.024  1.000 -0.162 -0.050 -0.761  0.615  0.015
        3  0.18846   0.011 -0.162  1.000 -0.023  0.185 -0.114 -0.001
        4  0.59842  -0.263 -0.050 -0.023  1.000 -0.138  0.417 -0.151
        5  0.78643   0.067 -0.761  0.185 -0.138  1.000 -0.585  0.037
        6  0.77118  -0.201  0.615 -0.114  0.417 -0.585  1.000 -0.116
        7  0.17890   0.073  0.015 -0.001 -0.151  0.037 -0.116  1.000
 **********
 **    7 **SET ERR         0.5
 **********
 **********
 **    8 **SET PRINT           1
 **********
 **********
 **    9 **HESSE        3500
 **********
 COVARIANCE MATRIX CALCULATED SUCCESSFULLY
 FCN=-19349.5 FROM HESSE     STATUS=OK             50 CALLS         525 TOTAL
                     EDM=0.000105035    STRATEGY= 2      ERROR MATRIX ACCURATE 
  EXT PARAMETER                                INTERNAL      INTERNAL  
  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   
   1  bkgYield     9.70784e+03   1.06704e+02   1.13166e-04   8.95889e-01
   2  frac1        7.03898e-01   6.98569e-02   2.94442e-04   4.13498e-01
   3  mean         5.61942e+03   2.78317e-01   1.30635e-03  -6.16005e-01
   4  sigYield     1.19507e+03   5.36609e+01   7.24810e-05  -1.35172e+00
   5  sigma1       5.75108e+00   4.39024e-01   2.93296e-04  -2.02215e+00
   6  sigma2       1.90817e+01   1.33312e+01   5.36639e-04   1.10167e+00
   7  tau         -1.93966e-03   4.77873e-05   2.27555e-04   6.58694e-01
                               ERR DEF= 0.5
 EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  7    ERR DEF=0.5
  1.139e+04 -3.300e-01  7.171e-01 -1.684e+03  5.753e+00 -1.388e+02  4.372e-04 
 -3.300e-01  4.919e-03 -3.581e-03  3.302e-01 -2.476e-02  2.551e-01 -8.396e-08 
  7.171e-01 -3.581e-03  8.066e-02 -7.174e-01  2.518e-02 -2.049e-01  8.877e-08 
 -1.684e+03  3.302e-01 -7.174e-01  2.880e+03 -5.756e+00  1.389e+02 -4.374e-04 
  5.753e+00 -2.476e-02  2.518e-02 -5.756e+00  1.939e-01 -1.530e+00  1.472e-06 
 -1.388e+02  2.551e-01 -2.049e-01  1.389e+02 -1.530e+00  2.687e+01 -3.614e-05 
  4.372e-04 -8.396e-08  8.877e-08 -4.374e-04  1.472e-06 -3.614e-05  2.284e-09 
 PARAMETER  CORRELATION COEFFICIENTS  
       NO.  GLOBAL      1      2      3      4      5      6      7
        1  0.34104   1.000 -0.044  0.024 -0.294  0.122 -0.251  0.086
        2  0.86927  -0.044  1.000 -0.180  0.088 -0.802  0.702 -0.025
        3  0.20407   0.024 -0.180  1.000 -0.047  0.201 -0.139  0.007
        4  0.64504  -0.294  0.088 -0.047  1.000 -0.244  0.499 -0.171
        5  0.82451   0.122 -0.802  0.201 -0.244  1.000 -0.670  0.070
        6  0.83628  -0.251  0.702 -0.139  0.499 -0.670  1.000 -0.146
        7  0.19897   0.086 -0.025  0.007 -0.171  0.070 -0.146  1.000
[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization
Starting MakePlots()
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (sig1)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (sig)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (sig2)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (sig)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (sig)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (sig1,sig2)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (bkg)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: ()
chi square1 = 1.1918
RooArgSet::parameters = (bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)
chi square2 = 1.23502
Pull Mean Y = -0.0793011
Pull RMS  Y = 1.08885
***************

  RooFitResult: minimized FCN value: -19349.5, estimated distance to minimum: 0.000105035
                covariance matrix quality: Full, accurate covariance matrix
                Status : MINIMIZE=0 HESSE=0 

    Floating Parameter  InitialValue    FinalValue +/-  Error     GblCorr.
  --------------------  ------------  --------------------------  --------
              bkgYield    5.4510e+03    9.7078e+03 +/-  1.07e+02  <none>
                 frac1    5.0000e-01    7.0390e-01 +/-  6.99e-02  <none>
                  mean    5.6194e+03    5.6194e+03 +/-  2.78e-01  <none>
              sigYield    5.0000e+03    1.1951e+03 +/-  5.37e+01  <none>
                sigma1    7.0000e+00    5.7511e+00 +/-  4.39e-01  <none>
                sigma2    7.0000e+00    1.9082e+01 +/-  1.33e+01  <none>
                   tau   -7.0000e-04   -1.9397e-03 +/-  4.78e-05  <none>

***************
covQual = 3
numStatusHistory = 2
0 MINIMIZE
0 HESSE
[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 0 entries
[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization
[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (sig,bkg)
[#1] INFO:Fitting -- RooAbsPdf::fitTo(model) Calculating sum-of-weights-squared correction matrix for covariance matrix
[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization
[#1] INFO:InputArguments -- Printing Yields
RooArgList:: = (sigYield,bkgYield)
[#1] INFO:InputArguments -- yield in pdf: sigYield 1194.78
[#1] INFO:InputArguments -- yield in pdf: bkgYield 9708.17
[#1] INFO:Eval -- Checking Likelihood normalization:  
[#1] INFO:Eval -- Yield of specie  Sum of Row in Matrix   Norm
[#1] INFO:Eval -- 1194.78 1194.77 1
[#1] INFO:Eval -- 9708.17 9708.12 1
[#1] INFO:Eval -- Calculating sWeight
Check SWeights:

Yield of signal is 1194.78.  From sWeights it is 1194.78
Yield of background is 9708.17.  From sWeights it is 9708.17

Signal Weight   -0.052724   Background Weight   1.05272  Total Weight   0.999995
Signal Weight   -0.052724   Background Weight   1.05272  Total Weight   0.999995
Signal Weight   -0.0523507   Background Weight   1.05235  Total Weight   0.999995
Signal Weight   -0.052724   Background Weight   1.05272  Total Weight   0.999995
Signal Weight   1.22174   Background Weight   -0.221744  Total Weight   0.999996
Signal Weight   -0.052724   Background Weight   1.05272  Total Weight   0.999995
Signal Weight   -0.052724   Background Weight   1.05272  Total Weight   0.999995
Signal Weight   -0.052724   Background Weight   1.05272  Total Weight   0.999995
Signal Weight   -0.052724   Background Weight   1.05272  Total Weight   0.999995
Signal Weight   0.518163   Background Weight   0.481833  Total Weight   0.999996

import new dataset with sWeights
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing dataset data
[#1] INFO:ObjectHandling -- RooWorkSpace::import(myWS) changing name of dataset from  data to dataWithSWeights
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigYield_sw
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::L_sigYield
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::bkgYield_sw
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::L_bkgYield
 after splot import data set looks like

RooWorkspace(myWS) myWS contents

variables
---------
(L_bkgYield,L_sigYield,Lb_DTF_M_JpsiLConstr,bkgYield,bkgYield_sw,frac1,mean,sigYield,sigYield_sw,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 1.90269e-05/0.016923
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.001629/1
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.00572972/1
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.0262551/14.4158
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.718465/47.8307

datasets
--------
RooDataSet::data(Lb_DTF_M_JpsiLConstr,sigYield_sw,L_sigYield,bkgYield_sw,L_bkgYield)
RooDataSet::dataWithSWeights(Lb_DTF_M_JpsiLConstr,sigYield_sw,L_sigYield,bkgYield_sw,L_bkgYield)

named sets
----------

reduceEng varSubset = (sigYield_sw) _wgtVar = 
No. of entries in dataset = 10903
************************************************
Writing output tree with unbinned sweighted data
************************************************
Finishing DoSPlot()
==> DoSWeight is done! Check fit status! sWeights FTW!: Real time 0:00:17, CP time 16.380
