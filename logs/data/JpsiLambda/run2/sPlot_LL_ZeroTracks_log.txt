********************************
==> Starting DoSWeight: 
Wed Dec 26 15:16:54 EST 2018
WD = /data1/avenkate/JpsiLambda_RESTART
********************************
******************************************
Processing Run 2 LL _ZeroTracks
******************************************
Incoming Entries = 80236
******************************************
Input file = rootFiles/dataFiles/JpsiLambda/run2/jpsilambda_cutoutks_LL_ZeroTracks.root
sWeighted Output file = rootFiles/dataFiles/JpsiLambda/run2/jpsilambda_LL_withsw_ZeroTracks.root
******************************************
Making mass cut on 80236 entries
0
Starting AddModel()
Making signal model
Making background model
Importing model into workspace
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooAddPdf::model
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooAddPdf::sig
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooGaussian::sig1
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::Lb_DTF_M_JpsiLConstr
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::mean
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigma1
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::frac1
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooGaussian::sig2
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigma2
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigYield
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooExponential::bkg
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::tau
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::bkgYield

RooWorkspace(myWS) myWS contents

variables
---------
(Lb_DTF_M_JpsiLConstr,bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 0.0198411
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.0205524
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.0213153
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.0213153
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.0213153

AddModel() complete
Starting AddData()
Importing data. This could take a while. Sit tight
[#1] INFO:Eval -- RooTreeDataStore::loadValues(data) Ignored 69509 out of range events
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing dataset data
[#1] INFO:ObjectHandling -- RooWorkSpace::import(myWS) changing name of dataset from  data to data

RooWorkspace(myWS) myWS contents

variables
---------
(Lb_DTF_M_JpsiLConstr,bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 0.0198411
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.0205524
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.0213153
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.0213153
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.0213153

datasets
--------
RooDataSet::data(Lb_DTF_M_JpsiLConstr)

Finishing AddData()

RooWorkspace(myWS) myWS contents

variables
---------
(Lb_DTF_M_JpsiLConstr,bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 0.0198411
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.0205524
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.0213153
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.0213153
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.0213153

datasets
--------
RooDataSet::data(Lb_DTF_M_JpsiLConstr)

Starting DoSPlot()
Calculating sWeights
[#1] INFO:Minization -- createNLL: caching constraint set under name CONSTR_OF_PDF_model_FOR_OBS_Lb_DTF_M_JpsiLConstr with 0 entries
[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization
[#1] INFO:Minization --  The following expressions will be evaluated in cache-and-track mode: (sig1,sig2,bkg)
 **********
 **    1 **SET PRINT           1
 **********
 **********
 **    2 **SET NOGRAD
 **********
 PARAMETER DEFINITIONS:
    NO.   NAME         VALUE      STEP SIZE      LIMITS
     1 bkgYield     5.36300e+03  1.07270e+03    0.00000e+00  1.07270e+04
     2 frac1        5.00000e-01  9.90000e-02    1.00000e-02  1.00000e+00
     3 mean         5.61942e+03  2.00000e-01    5.61900e+03  5.62100e+03
     4 sigYield     5.00000e+03  1.50000e+03    0.00000e+00  1.50000e+04
     5 sigma1       7.00000e+00  1.00000e+00    5.00000e+00  2.00000e+01
     6 sigma2       7.00000e+00  1.70000e+00    3.00000e+00  2.00000e+01
     7 tau         -7.00000e-04  3.49950e-04   -1.00000e-02 -1.00000e-07
 **********
 **    3 **SET ERR         0.5
 **********
 **********
 **    4 **SET PRINT           1
 **********
 **********
 **    5 **SET STR           2
 **********
 NOW USING STRATEGY  2: MAKE SURE MINIMUM TRUE, ERRORS CORRECT  
 **********
 **    6 **MIGRAD        3500           1
 **********
 FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.
 START MIGRAD MINIMIZATION.  STRATEGY  2.  CONVERGENCE WHEN EDM .LT. 1.00e-03
 MINUIT WARNING IN HESSE
 ============== Second derivative zero for parameter2
  MNHESS FAILS AND WILL RETURN DIAGONAL MATRIX. 
 FCN=-15185.3 FROM HESSE     STATUS=FAILED         11 CALLS          12 TOTAL
                     EDM=3428.44    STRATEGY= 2  ERROR MATRIX UNCERTAINTY 100.0 per cent
  EXT PARAMETER                APPROXIMATE        STEP         FIRST   
  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE 
   1  bkgYield     5.36300e+03   5.58936e+01   2.83786e-02  -3.95900e+03
   2  frac1        5.00000e-01   7.02412e-02   2.01369e-01   9.93203e+00
   3  mean         5.61942e+03   1.44637e-01   2.52435e-01   7.92284e+00
   4  sigYield     5.00000e+03   1.06791e+03   2.14402e-01   9.32826e+00
   5  sigma1       7.00000e+00   7.27597e-01   2.02490e-01   9.87702e+00
   6  sigma2       7.00000e+00   1.22237e+00   2.40891e-01   8.30252e+00
   7  tau         -7.00000e-04   2.55369e-04   1.41792e-01   1.41052e+01
                               ERR DEF= 0.5
 MIGRAD MINIMIZATION HAS CONVERGED.
 MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.
 COVARIANCE MATRIX CALCULATED SUCCESSFULLY
 FCN=-18840.8 FROM MIGRAD    STATUS=CONVERGED     563 CALLS         564 TOTAL
                     EDM=8.25385e-06    STRATEGY= 2      ERROR MATRIX ACCURATE 
  EXT PARAMETER                                   STEP         FIRST   
  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE 
   1  bkgYield     9.57872e+03   1.04370e+02   2.84619e-03   1.88559e-02
   2  frac1        3.34378e-01   9.83476e-02   7.85082e-03   3.94253e-03
   3  mean         5.61952e+03   2.88832e-01   3.10106e-02   4.08109e-03
   4  sigYield     1.14834e+03   4.97247e+01   9.51330e-04   3.05869e-02
   5  sigma1       1.60619e+01   3.98666e+00   2.89202e-02   1.87269e-03
   6  sigma2       5.65080e+00   5.32953e-01   4.07405e-03   2.51541e-02
   7  tau         -1.93089e-03   4.78298e-05   1.13136e-03   1.13320e-01
                               ERR DEF= 0.5
 EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  7    ERR DEF=0.5
  1.090e+04  8.655e-01  6.522e-01 -1.320e+03 -9.633e+01 -6.424e+00  3.452e-04 
  8.655e-01  9.820e-03  5.590e-03 -8.693e-01 -3.469e-01 -4.557e-02  2.245e-07 
  6.522e-01  5.590e-03  8.662e-02 -6.546e-01 -1.877e-01 -3.260e-02  6.931e-08 
 -1.320e+03 -8.693e-01 -6.546e-01  2.473e+03  9.670e+01  6.448e+00 -3.462e-04 
 -9.633e+01 -3.469e-01 -1.877e-01  9.670e+01  1.832e+01  1.663e+00 -2.530e-05 
 -6.424e+00 -4.557e-02 -3.260e-02  6.448e+00  1.663e+00  2.847e-01 -1.659e-06 
  3.452e-04  2.245e-07  6.931e-08 -3.462e-04 -2.530e-05 -1.659e-06  2.288e-09 
 PARAMETER  CORRELATION COEFFICIENTS  
       NO.  GLOBAL      1      2      3      4      5      6      7
        1  0.30001   1.000  0.084  0.021 -0.254 -0.216 -0.115  0.069
        2  0.92159   0.084  1.000  0.192 -0.176 -0.818 -0.862  0.047
        3  0.21032   0.021  0.192  1.000 -0.045 -0.149 -0.208  0.005
        4  0.59320  -0.254 -0.176 -0.045  1.000  0.454  0.243 -0.146
        5  0.88037  -0.216 -0.818 -0.149  0.454  1.000  0.728 -0.124
        6  0.86812  -0.115 -0.862 -0.208  0.243  0.728  1.000 -0.065
        7  0.17287   0.069  0.047  0.005 -0.146 -0.124 -0.065  1.000
 **********
 **    7 **SET ERR         0.5
 **********
 **********
 **    8 **SET PRINT           1
 **********
 **********
 **    9 **HESSE        3500
 **********
 COVARIANCE MATRIX CALCULATED SUCCESSFULLY
 FCN=-18840.8 FROM HESSE     STATUS=OK             50 CALLS         614 TOTAL
                     EDM=8.41104e-06    STRATEGY= 2      ERROR MATRIX ACCURATE 
  EXT PARAMETER                                INTERNAL      INTERNAL  
  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   
   1  bkgYield     9.57872e+03   1.04650e+02   1.13847e-04   9.04165e-01
   2  frac1        3.34378e-01   9.99957e-02   3.14033e-04  -3.51909e-01
   3  mean         5.61952e+03   2.88996e-01   1.24042e-03  -4.98908e-01
   4  sigYield     1.14834e+03   5.02504e+01   1.90266e-04  -1.01011e+00
   5  sigma1       1.60619e+01   4.04458e+00   2.31362e-04   4.94868e-01
   6  sigma2       5.65080e+00   5.42892e-01   1.62962e-04  -7.58925e-01
   7  tau         -1.93089e-03   4.78706e-05   2.26272e-04   6.60914e-01
                               ERR DEF= 0.5
 EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  7    ERR DEF=0.5
  1.096e+04  9.798e-01  7.032e-01 -1.376e+03 -1.028e+02 -7.015e+00  3.606e-04 
  9.798e-01  1.016e-02  5.759e-03 -9.802e-01 -3.603e-01 -4.750e-02  2.542e-07 
  7.032e-01  5.759e-03  8.672e-02 -7.035e-01 -1.937e-01 -3.379e-02  8.320e-08 
 -1.376e+03 -9.802e-01 -7.035e-01  2.525e+03  1.029e+02  7.017e+00 -3.607e-04 
 -1.028e+02 -3.603e-01 -1.937e-01  1.029e+02  1.895e+01  1.739e+00 -2.698e-05 
 -7.015e+00 -4.750e-02 -3.379e-02  7.017e+00  1.739e+00  2.955e-01 -1.812e-06 
  3.606e-04  2.542e-07  8.320e-08 -3.607e-04 -2.698e-05 -1.812e-06  2.292e-09 
 PARAMETER  CORRELATION COEFFICIENTS  
       NO.  GLOBAL      1      2      3      4      5      6      7
        1  0.30801   1.000  0.093  0.023 -0.262 -0.226 -0.123  0.072
        2  0.92431   0.093  1.000  0.194 -0.194 -0.821 -0.867  0.053
        3  0.21354   0.023  0.194  1.000 -0.048 -0.151 -0.211  0.006
        4  0.60446  -0.262 -0.194 -0.048  1.000  0.470  0.257 -0.150
        5  0.88454  -0.226 -0.821 -0.151  0.470  1.000  0.735 -0.129
        6  0.87326  -0.123 -0.867 -0.211  0.257  0.735  1.000 -0.070
        7  0.17758   0.072  0.053  0.006 -0.150 -0.129 -0.070  1.000
[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization
Starting MakePlots()
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (sig1)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (sig)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (sig2)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (sig)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (sig)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: (sig1,sig2)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) directly selected PDF components: (bkg)
[#1] INFO:Plotting -- RooAbsPdf::plotOn(model) indirectly selected PDF components: ()
chi square1 = 1.12569
RooArgSet::parameters = (bkgYield,frac1,mean,sigYield,sigma1,sigma2,tau)
chi square2 = 1.16652
Pull Mean Y = -0.0747772
Pull RMS  Y = 1.05885
***************

  RooFitResult: minimized FCN value: -18840.8, estimated distance to minimum: 8.41104e-06
                covariance matrix quality: Full, accurate covariance matrix
                Status : MINIMIZE=0 HESSE=0 

    Floating Parameter  InitialValue    FinalValue +/-  Error     GblCorr.
  --------------------  ------------  --------------------------  --------
              bkgYield    5.3630e+03    9.5787e+03 +/-  1.05e+02  <none>
                 frac1    5.0000e-01    3.3438e-01 +/-  1.00e-01  <none>
                  mean    5.6194e+03    5.6195e+03 +/-  2.89e-01  <none>
              sigYield    5.0000e+03    1.1483e+03 +/-  5.03e+01  <none>
                sigma1    7.0000e+00    1.6062e+01 +/-  4.04e+00  <none>
                sigma2    7.0000e+00    5.6508e+00 +/-  5.43e-01  <none>
                   tau   -7.0000e-04   -1.9309e-03 +/-  4.79e-05  <none>

***************
covQual = 3
numStatusHistory = 2
0 MINIMIZE
0 HESSE
[#1] INFO:Minization -- createNLL picked up cached consraints from workspace with 0 entries
[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization
[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (sig,bkg)
[#1] INFO:Fitting -- RooAbsPdf::fitTo(model) Calculating sum-of-weights-squared correction matrix for covariance matrix
[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization
[#1] INFO:InputArguments -- Printing Yields
RooArgList:: = (sigYield,bkgYield)
[#1] INFO:InputArguments -- yield in pdf: sigYield 1148.33
[#1] INFO:InputArguments -- yield in pdf: bkgYield 9578.67
[#1] INFO:Eval -- Checking Likelihood normalization:  
[#1] INFO:Eval -- Yield of specie  Sum of Row in Matrix   Norm
[#1] INFO:Eval -- 1148.33 1148.33 1
[#1] INFO:Eval -- 9578.67 9578.68 1
[#1] INFO:Eval -- Calculating sWeight
Check SWeights:

Yield of signal is 1148.33.  From sWeights it is 1148.33
Yield of background is 9578.67.  From sWeights it is 9578.67

Signal Weight   -0.049782   Background Weight   1.04978  Total Weight   1
Signal Weight   -0.049782   Background Weight   1.04978  Total Weight   1
Signal Weight   -0.0497641   Background Weight   1.04976  Total Weight   1
Signal Weight   -0.049782   Background Weight   1.04978  Total Weight   1
Signal Weight   1.20657   Background Weight   -0.206571  Total Weight   0.999998
Signal Weight   -0.049782   Background Weight   1.04978  Total Weight   1
Signal Weight   -0.049782   Background Weight   1.04978  Total Weight   1
Signal Weight   -0.049782   Background Weight   1.04978  Total Weight   1
Signal Weight   -0.049782   Background Weight   1.04978  Total Weight   1
Signal Weight   0.533466   Background Weight   0.466534  Total Weight   0.999999

import new dataset with sWeights
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing dataset data
[#1] INFO:ObjectHandling -- RooWorkSpace::import(myWS) changing name of dataset from  data to dataWithSWeights
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::sigYield_sw
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::L_sigYield
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::bkgYield_sw
[#1] INFO:ObjectHandling -- RooWorkspace::import(myWS) importing RooRealVar::L_bkgYield
 after splot import data set looks like

RooWorkspace(myWS) myWS contents

variables
---------
(L_bkgYield,L_sigYield,Lb_DTF_M_JpsiLConstr,bkgYield,bkgYield_sw,frac1,mean,sigYield,sigYield_sw,sigma1,sigma2,tau)

p.d.f.s
-------
RooExponential::bkg[ x=Lb_DTF_M_JpsiLConstr c=tau ] = 1.99853e-05/0.0177593
RooAddPdf::model[ sigYield * sig + bkgYield * bkg ] = 0.00166954/1
RooAddPdf::sig[ frac1 * sig1 + [%] * sig2 ] = 0.0062089/1
RooGaussian::sig1[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma1 ] = 0.62335/40.2611
RooGaussian::sig2[ x=Lb_DTF_M_JpsiLConstr mean=mean sigma=sigma2 ] = 0.0219574/14.1644

datasets
--------
RooDataSet::data(Lb_DTF_M_JpsiLConstr,sigYield_sw,L_sigYield,bkgYield_sw,L_bkgYield)
RooDataSet::dataWithSWeights(Lb_DTF_M_JpsiLConstr,sigYield_sw,L_sigYield,bkgYield_sw,L_bkgYield)

named sets
----------

reduceEng varSubset = (sigYield_sw) _wgtVar = 
No. of entries in dataset = 10727
************************************************
Writing output tree with unbinned sweighted data
************************************************
Finishing DoSPlot()
==> DoSWeight is done! Check fit status! sWeights FTW!: Real time 0:00:20, CP time 20.190
